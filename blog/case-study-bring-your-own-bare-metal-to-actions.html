<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="author" content="OpenFaaS Ltd"/><meta name="twitter:card" content="summary_large_image"/><title>Bring Your Own Metal Case Study with GitHub Actions</title><meta name="description" content="See how BYO bare-metal made a 6 hour GitHub Actions build complete 25x faster."/><meta property="twitter:title" content="Bring Your Own Metal Case Study with GitHub Actions"/><meta property="twitter:description" content="See how BYO bare-metal made a 6 hour GitHub Actions build complete 25x faster."/><meta property="og:title" content="Bring Your Own Metal Case Study with GitHub Actions"/><meta property="og:description" content="See how BYO bare-metal made a 6 hour GitHub Actions build complete 25x faster."/><meta name="twitter:image:src" content="https://actuated.dev/images/2023-03-vpp/background.jpg"/><meta property="og:image" content="https://actuated.dev/images/2023-03-vpp/background.jpg"/><meta name="next-head-count" content="13"/><meta charSet="utf-8"/><link rel="icon" type="image/png" href="/images/actuated.png"/><link rel="stylesheet" href="https://rsms.me/inter/inter.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css"/><link rel="manifest" href="/manifest.json"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-M5YNDNX7VT"></script><script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-M5YNDNX7VT');
          </script><link rel="apple-touch-icon" href="/images/actuated.png"/><link rel="preload" href="/_next/static/css/15b65ea57c2b2cf2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/15b65ea57c2b2cf2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-34e2100d07ae5757.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9eaa0e4bc2cfcc69.js" defer=""></script><script src="/_next/static/chunks/552-542f150c917a7625.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-109b0d2eddac75b5.js" defer=""></script><script src="/_next/static/Fz0wXaeVqFJgXNYx6dkDm/_buildManifest.js" defer=""></script><script src="/_next/static/Fz0wXaeVqFJgXNYx6dkDm/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-white"><header><div class="relative bg-white" data-headlessui-state=""><div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-6 sm:px-6 md:justify-start md:space-x-10 lg:px-8"><div class="flex justify-start lg:w-0 lg:flex-1"><a href="/"><span class="sr-only">Actuated</span><img class="h-8 w-auto sm:h-10" src="/images/actuated.png" alt="Actuated logo"/></a></div><div class="-my-2 -mr-2 md:hidden"><button class="inline-flex items-center justify-center rounded-md bg-white p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" type="button" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open menu</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div><nav class="hidden space-x-10 md:flex"><div class="relative" data-headlessui-state=""><button class="text-gray-500 group inline-flex items-center rounded-md bg-white text-base font-medium hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" type="button" aria-expanded="false" data-headlessui-state=""><span>Solutions</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="text-gray-400 ml-2 h-5 w-5 group-hover:text-gray-500"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path></svg></button></div><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/blog">Blog</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="https://actuated.dev/blog/blazing-fast-ci-with-microvms">Announcement</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="https://docs.actuated.dev/">Docs</a></nav><div class="hidden items-center justify-end md:flex md:flex-1 lg:w-0"><a href="https://dashboard.actuated.dev" class="whitespace-nowrap text-base font-medium text-gray-500 hover:text-gray-900">Sign in</a><a href="https://docs.actuated.dev/register/" class="ml-8 inline-flex items-center justify-center whitespace-nowrap rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700">Sign up</a></div></div></div></header><main><div class="container mx-auto max-w-4xl bg-white mt-4 px-4 sm:px-6"><h1 id="post_title" class="text-3xl mb-3 leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl sm:leading-10 text-center">Bring Your Own Metal Case Study with GitHub Actions</h1></div><div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl"><div class="border-b border-gray-200 py-4 flex items-center text-gray-500 mx-auto"><div><img class="h-10 w-10 rounded-full" src="/images/alex.jpg" alt=""/></div><div class="ml-3"><p id="post_author" class="text-sm leading-5 font-medium text-gray-900">Alex Ellis</p><div class="flex text-sm leading-5 text-gray-500"><time dateTime="2023-03-10" id="post_date">March 10, 2023</time><span class="mx-1"></span></div></div></div><div class="mt-6 prose sm:prose-lg max-w-none"><p id="post_description" class="mb-4">See how BYO bare-metal made a 6 hour GitHub Actions build complete 25x faster.</p></div><div id="post_content" class="mt-6 prose sm:prose-lg max-w-none"><p>I'm going to show you how both a regular x86_64 build and an Arm build were made dramatically faster by using Bring Your Own (BYO) bare-metal servers.</p>
<p>At the early stage of a project, GitHub's standard runners with 2x cores, 8GB RAM, and a little free disk space are perfect because they're free for public repos. For private repos they come in at a modest cost, if you keep your usage low.</p>
<p>What's not to love?</p>
<p>Well, <a href="https://twitter.com/edwarnicke?lang=en">Ed Warnicke</a>, Distinguished Engineer at Cisco contacted me a few weeks ago and told me about the VPP project, and some of the problems he was running into trying to build it with hosted runners.</p>
<blockquote>
<p>The Fast Data Project (FD.io) is an open-source project aimed at providing the world's fastest and most secure networking data plane through <a href="https://fd.io/">Vector Packet Processing (VPP)</a>.</p>
</blockquote>
<p>Whilst VPP can be used as a stand-alone project, it is also a key component in the <a href="https://www.cncf.io/">Cloud Computing Foundation's (CNCF's)</a> Open Source <a href="https://networkservicemesh.io/">Network Service Mesh</a> project.</p>
<p>There were two issues:</p>
<ol>
<li>
<p>The x86_64 build was taking 1 hour 25 minutes on a standard runner.</p>
<p>Why is that a problem? CI is meant to both validate against regression, but to build binaries for releases. If that process can take 50 minutes before failing, it's incredibly frustrating. For an open source project, it's actively hostile to contributors.</p>
</li>
<li>
<p>The Arm build was hitting the 6 hour limit for GitHub Actions then failing</p>
<p>Why? Well it was using <a href="https://www.qemu.org/">QEMU</a>, and I've spoken about this in the past - QEMU is a brilliant, zero cost way to build Arm binaries on a regular machine, but it's slow. And you'll see just how slow in the examples below, including where my Raspberry Pi beat a GitHub runner.</p>
</li>
</ol>
<p>We explain how to use QEMU in Docker Actions in the following blog post:</p>
<p><a href="https://actuated.dev/blog/multi-arch-docker-github-actions">The efficient way to publish multi-arch containers from GitHub Actions</a></p>
<h2>Rubbing some bare-metal on it</h2>
<p>So GitHub does actually have a beta going for "larger runners", and if Ed wanted to try that out, he'd have to apply to a beta waitlist, upgrade to a Team or Enterprise Plan, and then pick a new runner size.</p>
<p>But that wouldn't have covered him for the Arm build, GitHub don't have any support there right now. I'm sure it will come one, day, but here we are unable to release binaries for our Arm users.</p>
<p>With actuated, we have no interest in competing with GitHub's business model of selling compute on demand. We want to do something more unique than that - we want to enable you to bring your own (BYO) devices and then use them as runners, with VM-level isolation and one-shot runners.</p>
<blockquote>
<p>What does Bring Your Own (BYO) mean?</p>
<p>"Your Own" does not have to mean physical ownership. You do not need to own a datacenter, or to send off a dozen Mac Minis to a Colo.
You can provision bare-metal servers on AWS or with Equinix Metal as quickly as you can get an EC2 instance.
Actually, bare-metal isn't strictly needed at all, and even DigitalOcean's and Azure's VMs will work with actuated because they support KVM, which we use to launch Firecracker.</p>
</blockquote>
<p>And who is behind actuated? We are a nimble team, but have a pedigree with Cloud Native and self-hosted software going back 6-7 years from <a href="https://openfaas.com/">OpenFaaS</a>. OpenFaaS is a well known serverless platform which is used widely in production by commercial companies including Fortune 500s.</p>
<p>Actuated uses a Bring Your Own (BYO) server model, but there's very little for you to do once you've installed the actuated agent.</p>
<p>Here's how to set up the agent software: <a href="https://docs.actuated.dev/install-agent/">Actuated Docs: Install the Agent</a>.</p>
<p>You then get detailed stats about each runner, the build queue and insights across your whole GitHub organisation, in one place:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Actuated now aggregates usage data at the organisation level, so you can get insights and spot changes in behaviour.<br><br>This peak of 57 jobs was when I was quashing CVEs for <a href="https://twitter.com/openfaas?ref_src=twsrc%5Etfw">@openfaas</a> Pro customers in Alpine Linux and a bunch of Go <a href="https://t.co/a84wLNYYjo">https://t.co/a84wLNYYjo</a>… <a href="https://t.co/URaxgMoQGW">https://t.co/URaxgMoQGW</a> <a href="https://t.co/IuPQUjyiAY">pic.twitter.com/IuPQUjyiAY</a></p>&mdash; Alex Ellis (@alexellisuk) <a href="https://twitter.com/alexellisuk/status/1633059062639108096?ref_src=twsrc%5Etfw">March 7, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h2>First up - x86_64</h2>
<p>I forked Ed's repo into the "actuated-samples" repo, and edited the "runs-on:" field from "ubuntu-latest" to "actuated".</p>
<p>The build which previously took 1 hour 25 minutes now took 18 minutes 58 seconds. That's a 4.4x improvement.</p>
<p><img src="/images/2023-03-vpp/x86.png" alt="Improvements over the standard runner"></p>
<p>4.4x doesn't sound like a big number, but look at the actual number.</p>
<p>It used to take well over an hour to get feedback, now you get it in less than 20 minutes.</p>
<p>And for context, this x86_64 build took 17 minutes to build on Ed's laptop, with some existing caches in place.</p>
<p>I used an <a href="https://deploy.equinix.com/product/servers/m3-small/">Equinix Metal m3.small.x86 server</a>, which has 8x Intel Xeon E-2378G cores @ 2.8 GHz. It also comes with a local SSD, local NVMe would have been faster here.</p>
<p>The Firecracker VM that was launched had 12GB of RAM and 8x vCPUs allocated.</p>
<h2>Next up - Arm</h2>
<p>For the Arm build I created a new branch and had to change a few hard-coded references from "_amd64.deb" to "_arm64.deb" and then I was able to run the build. This is common enablement work. I've been doing Arm enablement for Cloud Native and OSS since 2015, so I'm very used to spotting this kind of thing.</p>
<p>So the build took 6 hours, and didn't even complete when running with QEMU.</p>
<p>How long did it take on bare-metal? 14 minutes 28 seconds.</p>
<p><img src="/images/2023-03-vpp/arm64.png" alt="Improvements over QEMU"></p>
<p>That's a 25x improvement.</p>
<p>The Firecracker VM that we launched had 16GB of RAM and 8x vCPUs allocated.</p>
<p>It was running on a Mac Mini M1 configured with 16GB RAM, running with Asahi Linux. I bought it for development and testing, as a one-off cost, and it's a very fast machine.</p>
<p>But, this case-study is <em>not</em> specifically about using consumer hardware, or hardware plugged in under your desk.</p>
<p>Equinix Metal and Hetzner both have the Ampere Altra bare-metal server available on either an hourly or monthly basis, and AWS customers can get access to the a1.metal instance on an hourly basis too.</p>
<blockquote>
<p>To prove the point, that BYO means cloud servers, just as much as physically owned machines, <a href="https://github.com/actuated-samples/govpp/actions/runs/4391240138">I also ran the same build on an Ampere Altra from Equinix Metal</a> with 20 GB of RAM, and 32 vCPUs, it completed in 9 minutes 39 seconds.</p>
</blockquote>
<p>See our hosting recommendations: <a href="https://docs.actuated.dev/provision-server/">Actuated Docs: Provision a Server</a></p>
<p>In October last year, I benchmarked a Raspberry Pi 4 as an actuated server and pitted it directly against QEMU and GitHub's Hosted runners.</p>
<p>It was 24 minutes faster. That's how bad using QEMU can be instead of using bare-metal Arm.</p>
<blockquote class="twitter-tweet" data-conversation="none"><p lang="en" dir="ltr">Then, just for run I scheduled the MicroVM on my <a href="https://twitter.com/Raspberry_Pi?ref_src=twsrc%5Etfw">@Raspberry_Pi</a> instead of an <a href="https://twitter.com/equinixmetal?ref_src=twsrc%5Etfw">@equinixmetal</a> machine.<br><br>Poor little thing has 8GB RAM and 4 Cores with an SSD connected over USB-C.<br><br>Anyway, it still beat QEMU by 24 minutes! <a href="https://t.co/ITyRpbnwEE">pic.twitter.com/ITyRpbnwEE</a></p>&mdash; Alex Ellis (@alexellisuk) <a href="https://twitter.com/alexellisuk/status/1583092051398524928?ref_src=twsrc%5Etfw">October 20, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h2>Wrapping up</h2>
<p>So, wrapping up - if you only build x86_64, and have very few build minutes, and are willing to upgrade to a Team or Enterprise Plan on GitHub, "faster runners" may be an option you want to consider.</p>
<p>If you don't want to worry about how many minutes you're going to use, or surprise bills because your team got more productive, or grew in size, or is finally running those 2 hour E2E tests every night, then actuated may be faster and better value overall for you.</p>
<p>But if you need Arm runners, and <a href="https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions">want to use them with public repos</a>, then there are not many options for you which are going to be secure and easy to manage.</p>
<h3>A recap on the results</h3>
<p><a href="https://twitter.com/alexellisuk/status/1634128821124313091?s=20"><img src="/images/2023-03-vpp/background.jpg" alt="The improvement on the x86 build"></a></p>
<blockquote>
<p><a href="https://twitter.com/alexellisuk/status/1634128821124313091?s=20">The improvement on the x86 build</a></p>
</blockquote>
<p>You can see the builds here:</p>
<p>x86_64 - 4.4x improvement</p>
<ul>
<li>Before: 1 hour 25 minutes - <a href="https://github.com/edwarnicke/govpp/actions/runs/3622982661">x86_64 build on a hosted runner</a></li>
<li>After: 18 minutes - 58 seconds <a href="https://github.com/actuated-samples/govpp/actions/runs/4383082399">x86_64 build on Equinix Metal</a></li>
</ul>
<p>Arm - 25x improvement</p>
<ul>
<li>Before: 6 hours (and failing) - <a href="https://github.com/edwarnicke/govpp/actions/runs/3643464160">Arm/QEMU build on a hosted runner</a></li>
<li>After: 14 minutes 28 seconds - <a href="https://github.com/actuated-samples/govpp/actions/runs/4383475307">Arm build on Mac Mini M1</a></li>
</ul>
<h3>Want to work with us?</h3>
<p>Want to get in touch with us and try out actuated for your team?</p>
<p>We're looking for pilot customers who want to speed up their builds, or make self-hosted runners simpler to manager, and ultimately, about as secure as they're going to get with MicroVM isolation.</p>
<p>Set up a 30 min call with me to ask any questions you may have and find out next steps.</p>
<ul>
<li><a href="https://docs.google.com/forms/d/e/1FAIpQLScA12IGyVFrZtSAp2Oj24OdaSMloqARSwoxx3AZbQbs0wpGww/viewform">Register for the actuated pilot</a></li>
</ul>
<p>Learn more about how it compares to other solutions in the FAQ: <a href="https://docs.actuated.dev/faq">Actuated FAQ</a></p>
<p>See also:</p>
<ul>
<li><a href="https://actuated.dev/blog/multi-arch-docker-github-actions">The efficient way to publish multi-arch containers from GitHub Actions</a></li>
<li><a href="https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions">Is the GitHub Actions self-hosted runner safe for Open Source?</a></li>
<li><a href="https://actuated.dev/blog/native-arm64-for-github-actions">How to make GitHub Actions 22x faster with bare-metal Arm</a></li>
</ul></div></div></main><footer class="bg-white"><div class="mx-auto max-w-7xl py-12 px-4 sm:px-6 md:flex md:items-center md:justify-between lg:px-8"><div class="flex justify-center space-x-6 md:order-2"><a class="text-gray-400 hover:text-gray-500" href="https://twitter.com/self-actuated"><span class="sr-only">Twitter</span><svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a><a class="text-gray-400 hover:text-gray-500" href="https://github.com/self-actuated"><span class="sr-only">GitHub</span><svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg></a><a class="text-gray-400 hover:text-gray-500" href="/rss.xml"><span class="sr-only">RSS</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 19.5v-.75a7.5 7.5 0 00-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"></path></svg></a></div><div class="mt-8 md:order-1 md:mt-0"><p class="text-center text-base text-gray-400">© 2022 <a href="https://openfaas.com">OpenFaaS Ltd</a>, Inc. All rights reserved.</p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"case-study-bring-your-own-bare-metal-to-actions","fileName":"2023-03-10-case-study-bring-your-own-bare-metal-to-actions.md","contentHtml":"\u003cp\u003eI'm going to show you how both a regular x86_64 build and an Arm build were made dramatically faster by using Bring Your Own (BYO) bare-metal servers.\u003c/p\u003e\n\u003cp\u003eAt the early stage of a project, GitHub's standard runners with 2x cores, 8GB RAM, and a little free disk space are perfect because they're free for public repos. For private repos they come in at a modest cost, if you keep your usage low.\u003c/p\u003e\n\u003cp\u003eWhat's not to love?\u003c/p\u003e\n\u003cp\u003eWell, \u003ca href=\"https://twitter.com/edwarnicke?lang=en\"\u003eEd Warnicke\u003c/a\u003e, Distinguished Engineer at Cisco contacted me a few weeks ago and told me about the VPP project, and some of the problems he was running into trying to build it with hosted runners.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe Fast Data Project (FD.io) is an open-source project aimed at providing the world's fastest and most secure networking data plane through \u003ca href=\"https://fd.io/\"\u003eVector Packet Processing (VPP)\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWhilst VPP can be used as a stand-alone project, it is also a key component in the \u003ca href=\"https://www.cncf.io/\"\u003eCloud Computing Foundation's (CNCF's)\u003c/a\u003e Open Source \u003ca href=\"https://networkservicemesh.io/\"\u003eNetwork Service Mesh\u003c/a\u003e project.\u003c/p\u003e\n\u003cp\u003eThere were two issues:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eThe x86_64 build was taking 1 hour 25 minutes on a standard runner.\u003c/p\u003e\n\u003cp\u003eWhy is that a problem? CI is meant to both validate against regression, but to build binaries for releases. If that process can take 50 minutes before failing, it's incredibly frustrating. For an open source project, it's actively hostile to contributors.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe Arm build was hitting the 6 hour limit for GitHub Actions then failing\u003c/p\u003e\n\u003cp\u003eWhy? Well it was using \u003ca href=\"https://www.qemu.org/\"\u003eQEMU\u003c/a\u003e, and I've spoken about this in the past - QEMU is a brilliant, zero cost way to build Arm binaries on a regular machine, but it's slow. And you'll see just how slow in the examples below, including where my Raspberry Pi beat a GitHub runner.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eWe explain how to use QEMU in Docker Actions in the following blog post:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://actuated.dev/blog/multi-arch-docker-github-actions\"\u003eThe efficient way to publish multi-arch containers from GitHub Actions\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eRubbing some bare-metal on it\u003c/h2\u003e\n\u003cp\u003eSo GitHub does actually have a beta going for \"larger runners\", and if Ed wanted to try that out, he'd have to apply to a beta waitlist, upgrade to a Team or Enterprise Plan, and then pick a new runner size.\u003c/p\u003e\n\u003cp\u003eBut that wouldn't have covered him for the Arm build, GitHub don't have any support there right now. I'm sure it will come one, day, but here we are unable to release binaries for our Arm users.\u003c/p\u003e\n\u003cp\u003eWith actuated, we have no interest in competing with GitHub's business model of selling compute on demand. We want to do something more unique than that - we want to enable you to bring your own (BYO) devices and then use them as runners, with VM-level isolation and one-shot runners.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhat does Bring Your Own (BYO) mean?\u003c/p\u003e\n\u003cp\u003e\"Your Own\" does not have to mean physical ownership. You do not need to own a datacenter, or to send off a dozen Mac Minis to a Colo.\nYou can provision bare-metal servers on AWS or with Equinix Metal as quickly as you can get an EC2 instance.\nActually, bare-metal isn't strictly needed at all, and even DigitalOcean's and Azure's VMs will work with actuated because they support KVM, which we use to launch Firecracker.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAnd who is behind actuated? We are a nimble team, but have a pedigree with Cloud Native and self-hosted software going back 6-7 years from \u003ca href=\"https://openfaas.com/\"\u003eOpenFaaS\u003c/a\u003e. OpenFaaS is a well known serverless platform which is used widely in production by commercial companies including Fortune 500s.\u003c/p\u003e\n\u003cp\u003eActuated uses a Bring Your Own (BYO) server model, but there's very little for you to do once you've installed the actuated agent.\u003c/p\u003e\n\u003cp\u003eHere's how to set up the agent software: \u003ca href=\"https://docs.actuated.dev/install-agent/\"\u003eActuated Docs: Install the Agent\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eYou then get detailed stats about each runner, the build queue and insights across your whole GitHub organisation, in one place:\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eActuated now aggregates usage data at the organisation level, so you can get insights and spot changes in behaviour.\u003cbr\u003e\u003cbr\u003eThis peak of 57 jobs was when I was quashing CVEs for \u003ca href=\"https://twitter.com/openfaas?ref_src=twsrc%5Etfw\"\u003e@openfaas\u003c/a\u003e Pro customers in Alpine Linux and a bunch of Go \u003ca href=\"https://t.co/a84wLNYYjo\"\u003ehttps://t.co/a84wLNYYjo\u003c/a\u003e… \u003ca href=\"https://t.co/URaxgMoQGW\"\u003ehttps://t.co/URaxgMoQGW\u003c/a\u003e \u003ca href=\"https://t.co/IuPQUjyiAY\"\u003epic.twitter.com/IuPQUjyiAY\u003c/a\u003e\u003c/p\u003e\u0026mdash; Alex Ellis (@alexellisuk) \u003ca href=\"https://twitter.com/alexellisuk/status/1633059062639108096?ref_src=twsrc%5Etfw\"\u003eMarch 7, 2023\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\u003ch2\u003eFirst up - x86_64\u003c/h2\u003e\n\u003cp\u003eI forked Ed's repo into the \"actuated-samples\" repo, and edited the \"runs-on:\" field from \"ubuntu-latest\" to \"actuated\".\u003c/p\u003e\n\u003cp\u003eThe build which previously took 1 hour 25 minutes now took 18 minutes 58 seconds. That's a 4.4x improvement.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2023-03-vpp/x86.png\" alt=\"Improvements over the standard runner\"\u003e\u003c/p\u003e\n\u003cp\u003e4.4x doesn't sound like a big number, but look at the actual number.\u003c/p\u003e\n\u003cp\u003eIt used to take well over an hour to get feedback, now you get it in less than 20 minutes.\u003c/p\u003e\n\u003cp\u003eAnd for context, this x86_64 build took 17 minutes to build on Ed's laptop, with some existing caches in place.\u003c/p\u003e\n\u003cp\u003eI used an \u003ca href=\"https://deploy.equinix.com/product/servers/m3-small/\"\u003eEquinix Metal m3.small.x86 server\u003c/a\u003e, which has 8x Intel Xeon E-2378G cores @ 2.8 GHz. It also comes with a local SSD, local NVMe would have been faster here.\u003c/p\u003e\n\u003cp\u003eThe Firecracker VM that was launched had 12GB of RAM and 8x vCPUs allocated.\u003c/p\u003e\n\u003ch2\u003eNext up - Arm\u003c/h2\u003e\n\u003cp\u003eFor the Arm build I created a new branch and had to change a few hard-coded references from \"_amd64.deb\" to \"_arm64.deb\" and then I was able to run the build. This is common enablement work. I've been doing Arm enablement for Cloud Native and OSS since 2015, so I'm very used to spotting this kind of thing.\u003c/p\u003e\n\u003cp\u003eSo the build took 6 hours, and didn't even complete when running with QEMU.\u003c/p\u003e\n\u003cp\u003eHow long did it take on bare-metal? 14 minutes 28 seconds.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2023-03-vpp/arm64.png\" alt=\"Improvements over QEMU\"\u003e\u003c/p\u003e\n\u003cp\u003eThat's a 25x improvement.\u003c/p\u003e\n\u003cp\u003eThe Firecracker VM that we launched had 16GB of RAM and 8x vCPUs allocated.\u003c/p\u003e\n\u003cp\u003eIt was running on a Mac Mini M1 configured with 16GB RAM, running with Asahi Linux. I bought it for development and testing, as a one-off cost, and it's a very fast machine.\u003c/p\u003e\n\u003cp\u003eBut, this case-study is \u003cem\u003enot\u003c/em\u003e specifically about using consumer hardware, or hardware plugged in under your desk.\u003c/p\u003e\n\u003cp\u003eEquinix Metal and Hetzner both have the Ampere Altra bare-metal server available on either an hourly or monthly basis, and AWS customers can get access to the a1.metal instance on an hourly basis too.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eTo prove the point, that BYO means cloud servers, just as much as physically owned machines, \u003ca href=\"https://github.com/actuated-samples/govpp/actions/runs/4391240138\"\u003eI also ran the same build on an Ampere Altra from Equinix Metal\u003c/a\u003e with 20 GB of RAM, and 32 vCPUs, it completed in 9 minutes 39 seconds.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eSee our hosting recommendations: \u003ca href=\"https://docs.actuated.dev/provision-server/\"\u003eActuated Docs: Provision a Server\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn October last year, I benchmarked a Raspberry Pi 4 as an actuated server and pitted it directly against QEMU and GitHub's Hosted runners.\u003c/p\u003e\n\u003cp\u003eIt was 24 minutes faster. That's how bad using QEMU can be instead of using bare-metal Arm.\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\" data-conversation=\"none\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eThen, just for run I scheduled the MicroVM on my \u003ca href=\"https://twitter.com/Raspberry_Pi?ref_src=twsrc%5Etfw\"\u003e@Raspberry_Pi\u003c/a\u003e instead of an \u003ca href=\"https://twitter.com/equinixmetal?ref_src=twsrc%5Etfw\"\u003e@equinixmetal\u003c/a\u003e machine.\u003cbr\u003e\u003cbr\u003ePoor little thing has 8GB RAM and 4 Cores with an SSD connected over USB-C.\u003cbr\u003e\u003cbr\u003eAnyway, it still beat QEMU by 24 minutes! \u003ca href=\"https://t.co/ITyRpbnwEE\"\u003epic.twitter.com/ITyRpbnwEE\u003c/a\u003e\u003c/p\u003e\u0026mdash; Alex Ellis (@alexellisuk) \u003ca href=\"https://twitter.com/alexellisuk/status/1583092051398524928?ref_src=twsrc%5Etfw\"\u003eOctober 20, 2022\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\u003ch2\u003eWrapping up\u003c/h2\u003e\n\u003cp\u003eSo, wrapping up - if you only build x86_64, and have very few build minutes, and are willing to upgrade to a Team or Enterprise Plan on GitHub, \"faster runners\" may be an option you want to consider.\u003c/p\u003e\n\u003cp\u003eIf you don't want to worry about how many minutes you're going to use, or surprise bills because your team got more productive, or grew in size, or is finally running those 2 hour E2E tests every night, then actuated may be faster and better value overall for you.\u003c/p\u003e\n\u003cp\u003eBut if you need Arm runners, and \u003ca href=\"https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions\"\u003ewant to use them with public repos\u003c/a\u003e, then there are not many options for you which are going to be secure and easy to manage.\u003c/p\u003e\n\u003ch3\u003eA recap on the results\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/alexellisuk/status/1634128821124313091?s=20\"\u003e\u003cimg src=\"/images/2023-03-vpp/background.jpg\" alt=\"The improvement on the x86 build\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/alexellisuk/status/1634128821124313091?s=20\"\u003eThe improvement on the x86 build\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eYou can see the builds here:\u003c/p\u003e\n\u003cp\u003ex86_64 - 4.4x improvement\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBefore: 1 hour 25 minutes - \u003ca href=\"https://github.com/edwarnicke/govpp/actions/runs/3622982661\"\u003ex86_64 build on a hosted runner\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eAfter: 18 minutes - 58 seconds \u003ca href=\"https://github.com/actuated-samples/govpp/actions/runs/4383082399\"\u003ex86_64 build on Equinix Metal\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eArm - 25x improvement\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBefore: 6 hours (and failing) - \u003ca href=\"https://github.com/edwarnicke/govpp/actions/runs/3643464160\"\u003eArm/QEMU build on a hosted runner\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eAfter: 14 minutes 28 seconds - \u003ca href=\"https://github.com/actuated-samples/govpp/actions/runs/4383475307\"\u003eArm build on Mac Mini M1\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eWant to work with us?\u003c/h3\u003e\n\u003cp\u003eWant to get in touch with us and try out actuated for your team?\u003c/p\u003e\n\u003cp\u003eWe're looking for pilot customers who want to speed up their builds, or make self-hosted runners simpler to manager, and ultimately, about as secure as they're going to get with MicroVM isolation.\u003c/p\u003e\n\u003cp\u003eSet up a 30 min call with me to ask any questions you may have and find out next steps.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.google.com/forms/d/e/1FAIpQLScA12IGyVFrZtSAp2Oj24OdaSMloqARSwoxx3AZbQbs0wpGww/viewform\"\u003eRegister for the actuated pilot\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLearn more about how it compares to other solutions in the FAQ: \u003ca href=\"https://docs.actuated.dev/faq\"\u003eActuated FAQ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eSee also:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://actuated.dev/blog/multi-arch-docker-github-actions\"\u003eThe efficient way to publish multi-arch containers from GitHub Actions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions\"\u003eIs the GitHub Actions self-hosted runner safe for Open Source?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://actuated.dev/blog/native-arm64-for-github-actions\"\u003eHow to make GitHub Actions 22x faster with bare-metal Arm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Bring Your Own Metal Case Study with GitHub Actions","description":"See how BYO bare-metal made a 6 hour GitHub Actions build complete 25x faster.","author":"Alex Ellis","tags":["baremetal","githubactions","equinixmetal","macmini","xeon"],"author_img":"alex","image":"/images/2023-03-vpp/background.jpg","date":"2023-03-10"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"case-study-bring-your-own-bare-metal-to-actions"},"buildId":"Fz0wXaeVqFJgXNYx6dkDm","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>