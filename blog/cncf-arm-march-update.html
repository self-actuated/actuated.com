<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="author" content="OpenFaaS Ltd"/><meta name="twitter:card" content="summary_large_image"/><title>The state of Arm CI for the CNCF</title><meta name="description" content="After running over 70k build minutes for top-tier CNCF projects, we give an update on the sponsored Arm CI program."/><meta property="twitter:title" content="The state of Arm CI for the CNCF"/><meta property="twitter:description" content="After running over 70k build minutes for top-tier CNCF projects, we give an update on the sponsored Arm CI program."/><meta property="og:title" content="The state of Arm CI for the CNCF"/><meta property="og:description" content="After running over 70k build minutes for top-tier CNCF projects, we give an update on the sponsored Arm CI program."/><meta name="twitter:image:src" content="https://actuated.dev/images/2024-03-cncf-update/background.png"/><meta property="og:image" content="https://actuated.dev/images/2024-03-cncf-update/background.png"/><meta name="next-head-count" content="13"/><meta charSet="utf-8"/><link rel="icon" type="image/png" href="/images/actuated.png"/><link rel="stylesheet" href="https://rsms.me/inter/inter.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css"/><link rel="manifest" href="/manifest.json"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-M5YNDNX7VT"></script><script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-M5YNDNX7VT');
          </script><link rel="apple-touch-icon" href="/images/actuated.png"/><link rel="preload" href="/_next/static/css/931f0fc3815fa31d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/931f0fc3815fa31d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-34e2100d07ae5757.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba4f0f0b110ca3d9.js" defer=""></script><script src="/_next/static/chunks/552-542f150c917a7625.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-109b0d2eddac75b5.js" defer=""></script><script src="/_next/static/jVIaN2EnZLJJMpLLWXDw8/_buildManifest.js" defer=""></script><script src="/_next/static/jVIaN2EnZLJJMpLLWXDw8/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-white"><header><div class="relative bg-white" data-headlessui-state=""><div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-6 sm:px-6 md:justify-start md:space-x-10 lg:px-8"><div class="flex justify-start lg:w-0 lg:flex-1"><a href="/"><span class="sr-only">Actuated</span><img class="h-8 w-auto sm:h-10" src="/images/actuated.png" alt="Actuated logo"/></a></div><div class="-my-2 -mr-2 md:hidden"><button class="inline-flex items-center justify-center rounded-md bg-white p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" type="button" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open menu</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div><nav class="hidden space-x-10 md:flex"><div class="relative" data-headlessui-state=""><button class="text-gray-500 group inline-flex items-center rounded-md bg-white text-base font-medium hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" type="button" aria-expanded="false" data-headlessui-state=""><span>Solutions</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="text-gray-400 ml-2 h-5 w-5 group-hover:text-gray-500"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path></svg></button></div><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/blog">Blog</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="https://actuated.dev/blog/blazing-fast-ci-with-microvms">Announcement</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/pricing">Pricing</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="https://docs.actuated.dev/">Docs</a></nav><div class="hidden items-center justify-end md:flex md:flex-1 lg:w-0"><a href="https://dashboard.actuated.dev" class="whitespace-nowrap text-base font-medium text-gray-500 hover:text-gray-900">Sign in</a><a href="/pricing" class="ml-8 inline-flex items-center justify-center whitespace-nowrap rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700">Sign-up</a></div></div></div></header><main><div class="container mx-auto max-w-4xl bg-white mt-4 px-4 sm:px-6"><h1 id="post_title" class="text-3xl mb-3 leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl sm:leading-10 text-center">The state of Arm CI for the CNCF</h1></div><div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl"><div class="border-b border-gray-200 py-4 flex items-center text-gray-500 mx-auto"><div><img class="h-10 w-10 rounded-full" src="/images/alex.jpg" alt=""/></div><div class="ml-3"><p id="post_author" class="text-sm leading-5 font-medium text-gray-900"></p><div class="flex text-sm leading-5 text-gray-500"><time dateTime="2024-03-04" id="post_date">March 4, 2024</time><span class="mx-1"></span></div></div></div><div class="mt-6 prose sm:prose-lg max-w-none"><p id="post_description" class="mb-4">After running over 70k build minutes for top-tier CNCF projects, we give an update on the sponsored Arm CI program.</p></div><div id="post_content" class="mt-6 prose sm:prose-lg max-w-none"><p>It's now been 4 months since we <a href="https://actuated.dev/blog/arm-ci-cncf-ampere">kicked off the sponsored program with the Cloud Native Computing Foundation (CNCF) and Ampere to manage CI for the foundation's open source projects</a>. But even before that, <a href="https://calyptia.com/blog/scaling-builds-with-actuated">Calyptia, the maintainer of Fluent approached us to run Arm CI for the open source fluent repos</a>, so we've been running CI for CNCF projects since June 2023.</p>
<p>Over that time, we've got to work directly with some really bright, friendly, and helpful maintainers, who wanted to have a safe, fast and secure way to create release artifacts, test PRs, and to run end to end tests. Their alternative until this point was either to go against GitHub's own advice, and to <a href="https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions">run an unsafe, self-hosted runner on an open source repo</a>, or <a href="https://actuated.dev/blog/how-to-run-multi-arch-builds-natively">to use QEMU</a> that in the case of Fluent meant their 5 minute build took over 6 hours before failing.</p>
<p>You can find out more about why we put this program together in the original announcement: <a href="https://actuated.dev/blog/arm-ci-cncf-ampere">Announcing managed Arm CI for CNCF projects</a></p>
<h2>Measuring the impact</h2>
<p>When we started out, Chris Aniszczyk, the CNCF's CTO wanted to create a small pilot to see if there'd be enough demand for our service. The CNCF partnered with Ampere to co-fund the program, Ampere sell a number of Arm based CPUs - which they brand as "Cloud Native" because they're so dense in cores and highly power efficient. Equinix Metal provide the credits and the hosting via the <a href="https://www.cncf.io/blog/2021/10/13/announcing-the-cloud-native-credits-program/">Cloud Native Credits program</a>.</p>
<p>In a few weeks, not only did we fill up all available slots, but we personally hand-held and onboarded each of the project maintainers one by one, over Zoom, via GitHub, and Slack.</p>
<p>Why would maintainers of top-tier projects need our help? Our team and community has extensive experience porting code to Arm, and building for multiple CPUs. We were able to advise on best practices for splitting up builds, how to right-size VMs, were there to turn on esoteric Kernel modules and configurations, and to generally give them a running start.</p>
<p>Today, our records show that the CNCF projects enrolled have run a total of 70.3k minutes. That's almost the equivalent of a computer running tasks 24/7 for a total of 2 months solid, without a break.</p>
<p>Here's a list of the organisations we've onboarded so far, ordered by the total amount of build minutes. We added the date of their first actuated build to help add some context. As I mentioned in the introduction, fluent have been a paying customer since June 2023.</p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Organisation</th>
<th>Date of first actuated build</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>etcd-io (etcd, boltdb)</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>2</td>
<td>fluent</td>
<td>2023-06-07</td>
</tr>
<tr>
<td>3</td>
<td>falcosecurity</td>
<td>2023-12-06</td>
</tr>
<tr>
<td>4</td>
<td>containerd</td>
<td>2023-12-02</td>
</tr>
<tr>
<td>5</td>
<td>cilium (tetragon, cilium, ebpf-go)</td>
<td>2023-10-31</td>
</tr>
<tr>
<td>6</td>
<td>cri-o</td>
<td>2023-11-27</td>
</tr>
<tr>
<td>7</td>
<td>open-telemetry</td>
<td>2024-02-14</td>
</tr>
<tr>
<td>8</td>
<td>opencontainers (runc)</td>
<td>2023-12-15</td>
</tr>
<tr>
<td>9</td>
<td>argoproj</td>
<td>2024-01-30</td>
</tr>
</tbody>
</table>
<p><em>Ranked by build minutes consumed</em></p>
<p>Some organisations have been actuated on multiple projects like <a href="https://github.com/etcd-io/etcd">etcd-io</a>, with <a href="https://github.com/etcd-io/bbolt">boltdb</a> adding to their minutes, and <a href="https://github.com/cilium">cilium</a> where <a href="https://isovalent.com/blog/post/can-i-use-tetragon-without-cilium-yes/">tetragon</a> and <a href="https://github.com/cilium/ebpf">ebpf-go</a> are also now running Arm builds.</p>
<p>It's tempting to look at build minutes as the only metric, however, now that <a href="https://github.com/containerd/containerd">containerd</a>, <a href="https://github.com/opencontainers/runc">runc</a>, cilium, etcd, and various other core projects are built by actuated, the security of the supply chain has become far more certain.</p>
<p><strong>From 10,000ft</strong></p>
<p>Here's what we aimed for and have managed to achieve in a very short period of time:</p>
<ul>
<li>Maintainers have no infrastructure to maintain - in the case of etcd, 5 people are now off the hook for being on call to manually maintain servers</li>
<li>OSS projects can run their CI jobs securely on ephemeral runners, with no risk of side-effects</li>
<li>Equinix Metal that donates credits has reduced the total amount of servers allocated and greatly increased utilization</li>
</ul>
<p><strong>Making efficient use of shared resources</strong></p>
<p>After fluent, etcd was the second project to migrate off self-managed runners. They had the impression that one of their jobs needed 32 vCPU and 32GB of RAM, and when we monitored the shared server pool, we noticed barely any load on the servers. That led me to build a quick Linux profiling tool called vmmeter. When they ran the profiler, it turned out the job used a maximum of 1.3 vCPU and 3GB of RAM, that's not just a rounding error - that's a night and day difference.</p>
<p>You can learn how to try out vmmeter to right-size your jobs on actuated, or on GitHub's hosted runners.</p>
<p><a href="https://actuated.dev/blog/right-sizing-vms-github-actions">Right sizing VMs for GitHub Actions</a></p>
<p>The projects have had a fairly stable, steady-state of CI jobs throughout the day and night as contributors from around the globe send PRs and end to end tests run.</p>
<p>But with etcd-io in particular we started to notice on Monday or Tuesday that there was a surge of up to 200 jobs all at once. When we asked them about this, they told us Dependabot was the cause. It would send a number of PRs to bump dependencies and that would in turn trigger dozens of jobs.</p>
<p><img src="/images/2024-03-cncf-update/etcd-dependabot.png" alt="Thundering herd problem from dependabot"></p>
<blockquote>
<p>Thundering herd problem from dependabot</p>
</blockquote>
<p>It would clear itself down in time, but we spent a little time to automate adding in 1-2 extra servers for this period of the week, and we managed to get the queue cleared several times quicker. When the machines are no longer needed, they drain themselves and get deleted. This is important for efficient use of the CNCF's credits and Equinix Metal's fleet of Ampere Altra Q80 Arm servers.</p>
<p><strong>Giving insights to maintainers</strong></p>
<p>I got to meet up with <a href="https://twitter.com/estesp">Phil Estes</a> from the containerd project at FOSDEM. We are old friends and used to be Docker Captains together.</p>
<p>We looked at the daily usage stats, looked at the total amount of contributors that month and how many builds they'd had.</p>
<p><a href="https://twitter.com/alexellisuk/status/1753769476871405804/photo/3"><img src="https://pbs.twimg.com/media/GFakCn-WsAAMlR9?format=jpg&#x26;name=medium" alt="Phil checking out the actuated dashboard"></a></p>
<p>Then we opened up the organisation insights page and found that containerd had accounted for 14% of the total build minutes having only been onboarded in Dec 2023.</p>
<p><a href="https://twitter.com/alexellisuk/status/1753769476871405804/photo/2"><img src="https://pbs.twimg.com/media/GFakCn3XwAACA3b?format=jpg&#x26;name=medium" alt="Detailed usage"></a></p>
<p>We saw that there was a huge peak in jobs last month compared to this month, so he went off to the containerd Slack to ask about what had happened.</p>
<p><strong>Catching build time increases early</strong></p>
<p>Phil also showed me that he used to have a jimmy-rigged dashboard of his own to track build time increases, and at FOSDEM, my team did a mini hackathon to release our own way to show people their job time increases.</p>
<p>We call it "Job Outliers" and it can be used to track increases going back as far as 120 days from today.</p>
<p><img src="/images/2024-03-cncf-update/outliers-top.png" alt="Job Outliers for actuated&#x27;s VM builds"></p>
<p>Clicking "inspect" on any of the workflows will open up a separate plot link with deep links to the longest job seen on each day of that period of time.</p>
<p>So what changed for our own actuated VM builds in that week, to add 5+ minutes of build time?</p>
<p><img src="/images/2024-03-cncf-update/detail-plot.png" alt="Maximum build times per day across the period"></p>
<p>We started building eBPF into the Kernel image, and the impact was 2x 2.5 minutes of build time.</p>
<p>This feature was originally requested by Toolpath, a commercial user of actuated with very intensive Julia builds, and they have been using it to keep their build times in check. We're pleased to be able to offer every enhancement to the CNCF project maintainers too.</p>
<h2>Wrapping up</h2>
<p><strong>What are the project maintainers saying?</strong></p>
<p><a href="https://github.com/atoulme">Antoine Toulme</a>, maintainer of OpenTelemetry collectors:</p>
<blockquote>
<p>The OpenTelemetry project has been looking for ways to test arm64 to support it as a top tier distribution. Actuated offers a path for us to test on new operating systems, especially arm64, without having to spend any time setting up or maintaining runners. We were lucky to be the recipient of a loan from Ampere that gave us access to a dedicated ARM server, and it took us months to navigate setting up dedicated runners and has significant maintenance overhead. With Actuated, we just set a tag in our actions and everything else is taken care of.</p>
</blockquote>
<p><a href="https://github.com/LucaGuerra">Luca Guerra</a>, maintainer of Falco:</p>
<blockquote>
<p>Falco users need to deploy to ARM64 as a platform, and we as maintainers, need to make sure that this architecture is treated as a first class citizen. Falco is a complex piece of software that employs kernel instrumentation and so it is not trivial to properly test. Thanks to Actuated, we were able to quickly add ARM64 to our GitHub Actions CI/CD pipeline making it much easier to maintain, freeing up engineering time from infrastructure work.</p>
</blockquote>
<p><a href="https://github.com/saschagrunert">Sascha Grunert</a>, maintainer of Cri-o:</p>
<blockquote>
<p>The CRI-O project was able to seamlessly integrate Arm based CI with the support of Actuated. We basically had to convert our existing tests to a GitHub Actions matrix utilizing their powerful Arm runners. Integration and unit testing on Arm is another big step for CRI-O to provide a generally broader platform support. We also had to improve the test suite itself for better compatibility with other architectures than x86_64/arm64. This makes contributing to CRI-O on those platforms even simpler. I personally don’t see any better option than Actuated right now, because managing our own hardware is something we’d like to avoid to mainly focus on open source software development. The simplicity of the integration using Actuated helped us a lot, and our future goal is to extend the CRI-O test scenarios for that.</p>
</blockquote>
<h3>Summing up the program so far</h3>
<p>Through the sponsored program, actuated has now run over 70k build minutes for around 10 CNCF projects, and we've heard from a growing number of projects who would like access.</p>
<p>We've secured the supply chain by removing unsafe runners that GitHub says should definitely not be used for open source repositories, and we've lessened the burden of server management on already busy maintainers.</p>
<p>Whilst the original pilot program is now full, we have the capacity to onboard many other projects and would love to work with you. We are happy to offer a discounted subscription if your employer that sponsors your time on the said CNCF project will pay for it. Otherwise, contact us anyway, and we'll put you into email contact with <a href="https://www.linkedin.com/in/caniszczyk/">Chris Aniszczyk</a> so you can let him know how this would help you.</p></div></div></main><footer class="bg-white"><div class="mx-auto max-w-7xl py-12 px-4 sm:px-6 md:flex md:items-center md:justify-between lg:px-8"><div class="flex justify-center space-x-6 md:order-2"><a class="text-gray-400 hover:text-gray-500" href="https://twitter.com/selfactuated"><span class="sr-only">Twitter</span><svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a><a class="text-gray-400 hover:text-gray-500" href="https://github.com/self-actuated"><span class="sr-only">GitHub</span><svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg></a><a class="text-gray-400 hover:text-gray-500" href="/rss.xml"><span class="sr-only">RSS</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 19.5v-.75a7.5 7.5 0 00-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"></path></svg></a></div><div class="mt-8 md:order-1 md:mt-0"><p class="text-center text-base text-gray-400">© 2022 <a href="https://openfaas.com">OpenFaaS Ltd</a>, Inc. All rights reserved.</p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"cncf-arm-march-update","fileName":"2024-03-04-cncf-arm-march-update.md","contentHtml":"\u003cp\u003eIt's now been 4 months since we \u003ca href=\"https://actuated.dev/blog/arm-ci-cncf-ampere\"\u003ekicked off the sponsored program with the Cloud Native Computing Foundation (CNCF) and Ampere to manage CI for the foundation's open source projects\u003c/a\u003e. But even before that, \u003ca href=\"https://calyptia.com/blog/scaling-builds-with-actuated\"\u003eCalyptia, the maintainer of Fluent approached us to run Arm CI for the open source fluent repos\u003c/a\u003e, so we've been running CI for CNCF projects since June 2023.\u003c/p\u003e\n\u003cp\u003eOver that time, we've got to work directly with some really bright, friendly, and helpful maintainers, who wanted to have a safe, fast and secure way to create release artifacts, test PRs, and to run end to end tests. Their alternative until this point was either to go against GitHub's own advice, and to \u003ca href=\"https://actuated.dev/blog/is-the-self-hosted-runner-safe-github-actions\"\u003erun an unsafe, self-hosted runner on an open source repo\u003c/a\u003e, or \u003ca href=\"https://actuated.dev/blog/how-to-run-multi-arch-builds-natively\"\u003eto use QEMU\u003c/a\u003e that in the case of Fluent meant their 5 minute build took over 6 hours before failing.\u003c/p\u003e\n\u003cp\u003eYou can find out more about why we put this program together in the original announcement: \u003ca href=\"https://actuated.dev/blog/arm-ci-cncf-ampere\"\u003eAnnouncing managed Arm CI for CNCF projects\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eMeasuring the impact\u003c/h2\u003e\n\u003cp\u003eWhen we started out, Chris Aniszczyk, the CNCF's CTO wanted to create a small pilot to see if there'd be enough demand for our service. The CNCF partnered with Ampere to co-fund the program, Ampere sell a number of Arm based CPUs - which they brand as \"Cloud Native\" because they're so dense in cores and highly power efficient. Equinix Metal provide the credits and the hosting via the \u003ca href=\"https://www.cncf.io/blog/2021/10/13/announcing-the-cloud-native-credits-program/\"\u003eCloud Native Credits program\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eIn a few weeks, not only did we fill up all available slots, but we personally hand-held and onboarded each of the project maintainers one by one, over Zoom, via GitHub, and Slack.\u003c/p\u003e\n\u003cp\u003eWhy would maintainers of top-tier projects need our help? Our team and community has extensive experience porting code to Arm, and building for multiple CPUs. We were able to advise on best practices for splitting up builds, how to right-size VMs, were there to turn on esoteric Kernel modules and configurations, and to generally give them a running start.\u003c/p\u003e\n\u003cp\u003eToday, our records show that the CNCF projects enrolled have run a total of 70.3k minutes. That's almost the equivalent of a computer running tasks 24/7 for a total of 2 months solid, without a break.\u003c/p\u003e\n\u003cp\u003eHere's a list of the organisations we've onboarded so far, ordered by the total amount of build minutes. We added the date of their first actuated build to help add some context. As I mentioned in the introduction, fluent have been a paying customer since June 2023.\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRank\u003c/th\u003e\n\u003cth\u003eOrganisation\u003c/th\u003e\n\u003cth\u003eDate of first actuated build\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eetcd-io (etcd, boltdb)\u003c/td\u003e\n\u003ctd\u003e2023-10-24\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003efluent\u003c/td\u003e\n\u003ctd\u003e2023-06-07\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003efalcosecurity\u003c/td\u003e\n\u003ctd\u003e2023-12-06\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003econtainerd\u003c/td\u003e\n\u003ctd\u003e2023-12-02\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003ecilium (tetragon, cilium, ebpf-go)\u003c/td\u003e\n\u003ctd\u003e2023-10-31\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003ecri-o\u003c/td\u003e\n\u003ctd\u003e2023-11-27\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003eopen-telemetry\u003c/td\u003e\n\u003ctd\u003e2024-02-14\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003eopencontainers (runc)\u003c/td\u003e\n\u003ctd\u003e2023-12-15\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003eargoproj\u003c/td\u003e\n\u003ctd\u003e2024-01-30\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cem\u003eRanked by build minutes consumed\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eSome organisations have been actuated on multiple projects like \u003ca href=\"https://github.com/etcd-io/etcd\"\u003eetcd-io\u003c/a\u003e, with \u003ca href=\"https://github.com/etcd-io/bbolt\"\u003eboltdb\u003c/a\u003e adding to their minutes, and \u003ca href=\"https://github.com/cilium\"\u003ecilium\u003c/a\u003e where \u003ca href=\"https://isovalent.com/blog/post/can-i-use-tetragon-without-cilium-yes/\"\u003etetragon\u003c/a\u003e and \u003ca href=\"https://github.com/cilium/ebpf\"\u003eebpf-go\u003c/a\u003e are also now running Arm builds.\u003c/p\u003e\n\u003cp\u003eIt's tempting to look at build minutes as the only metric, however, now that \u003ca href=\"https://github.com/containerd/containerd\"\u003econtainerd\u003c/a\u003e, \u003ca href=\"https://github.com/opencontainers/runc\"\u003erunc\u003c/a\u003e, cilium, etcd, and various other core projects are built by actuated, the security of the supply chain has become far more certain.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eFrom 10,000ft\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eHere's what we aimed for and have managed to achieve in a very short period of time:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMaintainers have no infrastructure to maintain - in the case of etcd, 5 people are now off the hook for being on call to manually maintain servers\u003c/li\u003e\n\u003cli\u003eOSS projects can run their CI jobs securely on ephemeral runners, with no risk of side-effects\u003c/li\u003e\n\u003cli\u003eEquinix Metal that donates credits has reduced the total amount of servers allocated and greatly increased utilization\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eMaking efficient use of shared resources\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eAfter fluent, etcd was the second project to migrate off self-managed runners. They had the impression that one of their jobs needed 32 vCPU and 32GB of RAM, and when we monitored the shared server pool, we noticed barely any load on the servers. That led me to build a quick Linux profiling tool called vmmeter. When they ran the profiler, it turned out the job used a maximum of 1.3 vCPU and 3GB of RAM, that's not just a rounding error - that's a night and day difference.\u003c/p\u003e\n\u003cp\u003eYou can learn how to try out vmmeter to right-size your jobs on actuated, or on GitHub's hosted runners.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://actuated.dev/blog/right-sizing-vms-github-actions\"\u003eRight sizing VMs for GitHub Actions\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe projects have had a fairly stable, steady-state of CI jobs throughout the day and night as contributors from around the globe send PRs and end to end tests run.\u003c/p\u003e\n\u003cp\u003eBut with etcd-io in particular we started to notice on Monday or Tuesday that there was a surge of up to 200 jobs all at once. When we asked them about this, they told us Dependabot was the cause. It would send a number of PRs to bump dependencies and that would in turn trigger dozens of jobs.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2024-03-cncf-update/etcd-dependabot.png\" alt=\"Thundering herd problem from dependabot\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThundering herd problem from dependabot\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIt would clear itself down in time, but we spent a little time to automate adding in 1-2 extra servers for this period of the week, and we managed to get the queue cleared several times quicker. When the machines are no longer needed, they drain themselves and get deleted. This is important for efficient use of the CNCF's credits and Equinix Metal's fleet of Ampere Altra Q80 Arm servers.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eGiving insights to maintainers\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eI got to meet up with \u003ca href=\"https://twitter.com/estesp\"\u003ePhil Estes\u003c/a\u003e from the containerd project at FOSDEM. We are old friends and used to be Docker Captains together.\u003c/p\u003e\n\u003cp\u003eWe looked at the daily usage stats, looked at the total amount of contributors that month and how many builds they'd had.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/alexellisuk/status/1753769476871405804/photo/3\"\u003e\u003cimg src=\"https://pbs.twimg.com/media/GFakCn-WsAAMlR9?format=jpg\u0026#x26;name=medium\" alt=\"Phil checking out the actuated dashboard\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThen we opened up the organisation insights page and found that containerd had accounted for 14% of the total build minutes having only been onboarded in Dec 2023.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/alexellisuk/status/1753769476871405804/photo/2\"\u003e\u003cimg src=\"https://pbs.twimg.com/media/GFakCn3XwAACA3b?format=jpg\u0026#x26;name=medium\" alt=\"Detailed usage\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eWe saw that there was a huge peak in jobs last month compared to this month, so he went off to the containerd Slack to ask about what had happened.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eCatching build time increases early\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003ePhil also showed me that he used to have a jimmy-rigged dashboard of his own to track build time increases, and at FOSDEM, my team did a mini hackathon to release our own way to show people their job time increases.\u003c/p\u003e\n\u003cp\u003eWe call it \"Job Outliers\" and it can be used to track increases going back as far as 120 days from today.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2024-03-cncf-update/outliers-top.png\" alt=\"Job Outliers for actuated\u0026#x27;s VM builds\"\u003e\u003c/p\u003e\n\u003cp\u003eClicking \"inspect\" on any of the workflows will open up a separate plot link with deep links to the longest job seen on each day of that period of time.\u003c/p\u003e\n\u003cp\u003eSo what changed for our own actuated VM builds in that week, to add 5+ minutes of build time?\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2024-03-cncf-update/detail-plot.png\" alt=\"Maximum build times per day across the period\"\u003e\u003c/p\u003e\n\u003cp\u003eWe started building eBPF into the Kernel image, and the impact was 2x 2.5 minutes of build time.\u003c/p\u003e\n\u003cp\u003eThis feature was originally requested by Toolpath, a commercial user of actuated with very intensive Julia builds, and they have been using it to keep their build times in check. We're pleased to be able to offer every enhancement to the CNCF project maintainers too.\u003c/p\u003e\n\u003ch2\u003eWrapping up\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWhat are the project maintainers saying?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/atoulme\"\u003eAntoine Toulme\u003c/a\u003e, maintainer of OpenTelemetry collectors:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe OpenTelemetry project has been looking for ways to test arm64 to support it as a top tier distribution. Actuated offers a path for us to test on new operating systems, especially arm64, without having to spend any time setting up or maintaining runners. We were lucky to be the recipient of a loan from Ampere that gave us access to a dedicated ARM server, and it took us months to navigate setting up dedicated runners and has significant maintenance overhead. With Actuated, we just set a tag in our actions and everything else is taken care of.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/LucaGuerra\"\u003eLuca Guerra\u003c/a\u003e, maintainer of Falco:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFalco users need to deploy to ARM64 as a platform, and we as maintainers, need to make sure that this architecture is treated as a first class citizen. Falco is a complex piece of software that employs kernel instrumentation and so it is not trivial to properly test. Thanks to Actuated, we were able to quickly add ARM64 to our GitHub Actions CI/CD pipeline making it much easier to maintain, freeing up engineering time from infrastructure work.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/saschagrunert\"\u003eSascha Grunert\u003c/a\u003e, maintainer of Cri-o:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe CRI-O project was able to seamlessly integrate Arm based CI with the support of Actuated. We basically had to convert our existing tests to a GitHub Actions matrix utilizing their powerful Arm runners. Integration and unit testing on Arm is another big step for CRI-O to provide a generally broader platform support. We also had to improve the test suite itself for better compatibility with other architectures than x86_64/arm64. This makes contributing to CRI-O on those platforms even simpler. I personally don’t see any better option than Actuated right now, because managing our own hardware is something we’d like to avoid to mainly focus on open source software development. The simplicity of the integration using Actuated helped us a lot, and our future goal is to extend the CRI-O test scenarios for that.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003eSumming up the program so far\u003c/h3\u003e\n\u003cp\u003eThrough the sponsored program, actuated has now run over 70k build minutes for around 10 CNCF projects, and we've heard from a growing number of projects who would like access.\u003c/p\u003e\n\u003cp\u003eWe've secured the supply chain by removing unsafe runners that GitHub says should definitely not be used for open source repositories, and we've lessened the burden of server management on already busy maintainers.\u003c/p\u003e\n\u003cp\u003eWhilst the original pilot program is now full, we have the capacity to onboard many other projects and would love to work with you. We are happy to offer a discounted subscription if your employer that sponsors your time on the said CNCF project will pay for it. Otherwise, contact us anyway, and we'll put you into email contact with \u003ca href=\"https://www.linkedin.com/in/caniszczyk/\"\u003eChris Aniszczyk\u003c/a\u003e so you can let him know how this would help you.\u003c/p\u003e","title":"The state of Arm CI for the CNCF","description":"After running over 70k build minutes for top-tier CNCF projects, we give an update on the sponsored Arm CI program.","tags":["efficiency","githubactions","metering"],"author_img":"alex","image":"/images/2024-03-cncf-update/background.png","date":"2024-03-04"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"cncf-arm-march-update"},"buildId":"jVIaN2EnZLJJMpLLWXDw8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>